<!DOCTYPE HTML>
<html lang="fr">
<head>
	<title>LISTE DES CACHES - G√©ocaching Jeux de Sophia 2019</title>
	<% include ./partials/head %>
	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" />
	<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
</head>
<body>

	<% include ./partials/menu %>

	<div id="main" class="wrapper style4">

		<div id="intro" class="container">
			<section>
				<header class="major">
				<% if (start) { %>
					<h2>A VOUS DE CR√âER, CACHER, TROUVER !</h2>
						<span class="byline">üèÅ C'est parti, √† vous de cr√©er üéÅ</span>
					<br>
						<p>Si vous n'avez pas re√ßu l'email avec votre lien unique et personnel de cr√©ation, merci de nous contacter : <a href="mailto:geocaching@jeuxdesophia.com">geocaching@jeuxdesophia.com</a></p>
				<% } else { %>
					<script>
						TargetDate = "06/16/2019 16:00 PM";
						BackColor = "none";
						ForeColor = "none";
						CountActive = true;
						CountStepper = -1;
						LeadingZero = true;
						//DisplayFormat = "<h3>üèÅ Lancement de l'√©preuve dans %%D%% Jours, %%H%% Heures, %%M%% Minutes, %%S%% Secondes</h3>";
						//FinishMessage = "<h2>C'est parti ! A vous de CR√âER üéÅ</h2>";
						DisplayFormat = "<h3>üèÅ Fin de l'√©preuve dans %%D%% Jours, %%H%% Heures, %%M%% Minutes, %%S%% Secondes</h3>";
						FinishMessage = "<h2>C'est fini ! Merci √† tous üòò</h2>";
					</script>
					<script src="public/js/compteur.js"></script>
				<% } %>
		</header>

		<div style="display:flex; flex-wrap:wrap; justify-content:space-evenly; align-items: baseline;" class="clearfix">
			<% geocaches.forEach(function(geocache) { %>
				<div style="padding-right: 50px; padding-bottom: 15px;">
					<a href="/geocache?id=<%= geocache.id %>">
						<img width="220px;" class="border" src="<%= geocache.get("Photo").url().replace(/^[a-zA-Z]{3,5}\:\/{2}[a-zA-Z0-9_.:-]+\//, ''); %>" />
						<p style="text-align: center; width:210px; padding-top: 8px; font-size: 1.1em;">
							<img width="40px;" style="margin-right: 10px;" align="left" src="/public/images/<%= geocache.get('Category') %>BIG.gif"/><b><%= geocache.get("Nom") %></b>
						</p>
					</a>
				</div>
			<% }); %>
		</div> 
		
		<!--
			<div>
				<p>Derni√®re publication pour l'√©preuve : le 16 juin 2017. <br>Une Wherigo D5 vous attend : STAR. <br>Bon courage pour cette ultime et derni√®re √©tape avant la cache Challenge.</p>
			</div>
		-->
		<br>
		<div>
			Pour d√©couvrir les bonnes pratiques pour cr√©er une g√©ocache : <a href="/public/Guide-Geocaching-JDS2019.pdf">Le Guide g√©ocaching JDS 2019</a></p>
		</div>
	</section>

	</div>
</div>

<div class="wrapper style2">

	<div id="liste" class="container">
		<section>

			<h2>‚úçÔ∏è Les derniers logs</h2>
			<ul>
				<% logs.forEach(function(log) { %>

				<% if(log.get("Geocache").get("Active") == true)  { %>
					<li>
						<b><a href="/geocache?id=<%= log.get("Geocache").id %>"> <%= log.get("Geocache").get("Nom") %> </a> : <%= moment(log.get("Date")).utcOffset(120).fromNow() %> le <%= moment(log.get("Date")).utcOffset(120).format("LL [√†] LT") %> </b>- <%= log.get("Pseudo") %> : <i><%= log.get("Message") %></i>
						<% if(log.get("Fav") == true)  { %> - üëç <% } %>
					</li>
				<% } %>
				
				<% }); %>
				<li>[...]</li>
			</ul>
			<hr>
			<p class="medium">üé® Cr√©ation - du 20 mai au 9 juin - les participants qui le souhaitent peuvent cr√©er seul ou en groupe leur propre G√©ocache pendant cette p√©riode.
			<br>üîé Recherche - du 27 mai au 16 juin - tous les participants pourront d√©couvrir les caches pos√©es et publi√©es en premi√®re partie.</p>

			<p class="medium"><i>La plupart de ces caches sont sp√©cifiquement pos√©es pour les Jeux de Sophia et sont donc par cons√©quent non accessibles, ni m√™me visibles sur le site geocaching.com et les applications officielles G√©ocaching.com.</i></p>

			<div class="clearfix">
				<a href="/photoscaches" style="float: left;" align="left" class="button alt">üì∑ Galerie photos</a>
				<a href="/ranking" style="float: right;" align="right" class="button alt">üèÜ Voir le classement</a>
			</div>
		</section>
	</div>
</div>

<div class="wrapper style5">

	<div id="carte" class="container">

		<section>
			<header class="major">
				<h2>Carte des emplacements</h2>
				<span class="byline">Les coordonn√©es des caches de type "Mystery - ?" sont fictives, √† vous de les trouver ;-)</span>
			</header>


			<div id="map"></div>

			<script type="text/javascript">
				let map = L.map('map').setView([43.624, 7.052383], 13.5);

				L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
				    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>'
				}).addTo(map);

				let LeafIcon = L.Icon.extend({
				    options: {
				        iconAnchor:   [12, 12],
				        popupAnchor:  [7, -7]
				    }
				});

				let TRADI = new LeafIcon({iconUrl: 'public/images/TRADI.gif'}),
					MULTI = new LeafIcon({iconUrl: 'public/images/MULTI.gif'}),
					WHERIGO = new LeafIcon({iconUrl: 'public/images/WHERIGO.gif'}),
					VIRTUAL = new LeafIcon({iconUrl: 'public/images/VIRTUAL.gif'}),
					EARTHCACHE = new LeafIcon({iconUrl: 'public/images/EARTHCACHE.gif'}),
					LETTERBOX = new LeafIcon({iconUrl: 'public/images/LETTERBOX.gif'}),
					EVENT = new LeafIcon({iconUrl: 'public/images/EVENT.gif'}),
					SPECIAL = new LeafIcon({iconUrl: 'public/images/SPECIAL.gif'}),
					MYSTERY = new LeafIcon({iconUrl: 'public/images/MYSTERY.gif'});

				let geocaches = [
					<% geocaches.forEach(function(geocache) { %>
						new L.LatLng(<%= geocache.get("GPS").latitude %>, <%= geocache.get("GPS").longitude %>),
					<% }); %>
				];

				<% geocaches.forEach(function(geocache) { %>
					L.marker([<%= geocache.get("GPS").latitude %>, <%= geocache.get("GPS").longitude %>], {icon: <%= geocache.get("Category") %>}).addTo(map).bindPopup('<h3 style="color:#83B348;"><a href="/geocache?id=<%= geocache.id %>"><%= geocache.get("Nom") %></a></h3>');
				<% }); %>

				L.control.scale().addTo(map);

				let bounds = new L.LatLngBounds(geocaches);
				map.fitBounds(bounds, {padding: [50, 50]});

			</script>

			<br><br>
			<a href="/ranking" class="button alt">üèÜ Voir le classement</a>

			</section>
		</div>
	</div>

	<% include ./partials/footer %>
</body>
</html>
